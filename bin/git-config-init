#!/bin/bash -uxe
# config.git initialization script
#
# Run this to automatically install:
#     WARNING: WILL OVERWRITE YOUR .bashrc AND OTHER IMPORTANT FILES!
#     curl -L https://raw.github.com/nhooey/config/master/bin/git-config-init | bash

if ! git --version > /dev/null 2>&1; then
	echo 'git' is not installed.
fi

if [ "x$1" != "x" ]; then
	REPO=$1
elif [ -z $REPO ]; then
	REPO='git://github.com/nhooey/config.git'
fi

echo "Initializing config.git with repo: '$REPO'..."

cd ~

# Backup previous config.git stuff
mkdir backup-config.git
for file in bin .bash_profile .git .config.git; do
	if [ -e ${file} ]; then
		mv -fv "$file" backup-config.git/
	fi
done

git clone $REPO config.git
mv -fv config.git/.git .config.git
shopt -s dotglob
yes | mv -fi config.git/* .
rm -rfv config.git


git --git-dir=$HOME/.config.git/ --work-tree=$HOME remote set-url --push origin git@github.com:nhooey/config.git

# Install Vundle for Vim
git clone https://github.com/gmarik/vundle.git ~/.vim/bundle/vundle; vim +BundleInstall +qall

echo "Now log out and log in..."
